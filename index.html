<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="slideshow"></div>
    <div class="background-slideshow"></div>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <img id="loginLogo" src="logo.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ" style="width:240px;display:block;margin: auto 20px auto;">
            <h1>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
            <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
            
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="username">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</label>
                    <input type="text" id="username" required placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">
                </div>
                
                <div class="form-group">
                    <label for="password">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:</label>
                    <input type="password" id="password" required placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
                </div>
                
                <button type="submit" class="login-btn">
                    üîì ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                </button>
                
                <div class="login-error" id="loginError"></div>
            </form>
            
            <div class="login-footer">
                <p>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö: commu@rtaf.mi.th</p>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="container" style="display: none;">
        <div class="header-bar">
            <h1 style="display:flex;align-items:center;gap:10px;">
                <img src="logo.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ" style="height:64px;vertical-align:middle;"> ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
            </h1>
            <div class="user-info">
                <img id="userProfilePicSmall" src="" alt="‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå" style="height:32px;width:32px;border-radius:50%;border:1px solid #ccc;object-fit:cover;display:none;margin-right:8px;vertical-align:middle;cursor:pointer;" onclick="openUserSettings()">
                <span id="userDisplay" style="cursor:pointer;text-decoration:underline;vertical-align:middle;" onclick="openUserSettings()"></span>
                <button onclick="logout()" class="logout-btn">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            </div>
        </div>
        
        <div class="alert success" id="successAlert"></div>
        <div class="alert error" id="errorAlert"></div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('setup')">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
            <button class="tab" onclick="switchTab('attendance')">‚úÖ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</button>
        </div>

        <!-- Setup Tab -->
        <div id="setup" class="tab-content active">
            <div class="section">
                <h2>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
                
                <div class="form-group">
                    <label for="yearLevel">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ:</label>
                    <select id="yearLevel" onchange="updateClassOptions()">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ --</option>
                        <option value="1">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</option>
                        <option value="2">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="classSelect">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label>
                    <select id="classSelect" onchange="loadStudents()" disabled>
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏Å‡πà‡∏≠‡∏ô --</option>
                    </select>
                </div>
                
                
                <div class="form-group">
                    <label for="teacherName">‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠:</label>
                    <input type="text" id="teacherName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠">
                </div>
                
                <div class="form-group">
                    <label for="timeSlot">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤:</label>
                    <select id="timeSlot">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ --</option>
                        <option value="morning">üåÖ ‡∏†‡∏≤‡∏Ñ‡πÄ‡∏ä‡πâ‡∏≤ (08:00 - 12:00)</option>
                        <option value="afternoon">‚òÄÔ∏è ‡∏†‡∏≤‡∏Ñ‡∏ö‡πà‡∏≤‡∏¢ (13:00 - 16:00)</option>
                    </select>
                </div>
                
                
            </div>
        </div>

        <!-- Attendance Tab -->
        <div id="attendance" class="tab-content">
            <div class="section">
                <h2>‚úÖ ‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h2>
                <p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <strong id="currentDate"></strong></p>
                <p>‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ: <strong id="currentYear">-</strong></p>
                <p>‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <strong id="currentClass">-</strong></p>
                <p>‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô: <strong id="currentTeacher">-</strong></p>
                <p>‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤: <strong id="currentTimeSlot">-</strong></p>
                
                <div class="summary">
                    <div class="summary-card" style="border-left: 4px solid #28a745;">
                        <div class="summary-number" id="presentCount">0</div>
                        <div>‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                    </div>
                    <div class="summary-card" style="border-left: 4px solid #dc3545;">
                        <div class="summary-number" id="absentCount">0</div>
                        <div>‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                    </div>
                    <div class="summary-card" style="border-left: 4px solid #ffc107;">
                        <div class="summary-number" id="sickCount">0</div>
                        <div>‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</div>
                    </div>
                    <div class="summary-card" style="border-left: 4px solid #17a2b8;">
                        <div class="summary-number" id="activityCount">0</div>
                        <div>‡πÑ‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</div>
                    </div>
                    <div class="summary-card" style="border-left: 4px solid #6c757d;">
                        <div class="summary-number" id="homeCount">0</div>
                        <div>‡∏•‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô</div>
                    </div>
                </div>

                <div class="attendance-grid" id="attendanceGrid">
                    <!-- Student cards will be dynamically added here -->
                </div>

                <div style="margin-top: 20px; text-align: center;">
                    <button onclick="exportAttendanceToExcel()" style="padding: 15px 40px; font-size: 18px;">
                        üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Excel
                    </button>
                </div>
            </div>
        </div>

        <!-- Report Tab -->
        <div id="report" class="tab-content">
            <div class="section">
                <h2>üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠</h2>
                <div class="form-group">
                    <label for="reportDate">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                    <input type="date" id="reportDate" onchange="loadReport()">
                </div>
                
                <div class="form-group">
                    <label for="exportClassroom">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ/‡∏ï‡∏≠‡∏ô:</label>
                    <select id="exportClassroom" onchange="loadReport()">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ/‡∏ï‡∏≠‡∏ô --</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="exportTimeSlot">‡∏Ñ‡∏≤‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label>
                    <select id="exportTimeSlot" onchange="loadReport()">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≤‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --</option>
                    </select>
                </div>
                
                <div id="exportSection" style="margin: 20px 0; text-align: center;">
                    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
                
                <div style="margin: 20px 0; text-align: center;">
                    <button onclick="clearAllAttendanceHistory()" class="btn-clear-history">
                        üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    </button>
                </div>
                
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>

                <table class="attendance-table" id="reportTable" style="display: none;">
                    <thead>
                        <tr>
                            <th>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                            <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th>‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</th>
                            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</th>
                            <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="reportBody">
                        <!-- Report rows will be dynamically added here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Statistics Tab -->
        <div id="statistics" class="tab-content">
            <div class="section">
                <h2>üìà ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
                
               <div class="form-group">
                    <label for="statsClassroom">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ/‡∏ï‡∏≠‡∏ô:</label>
                    <select id="statsClassroom" onchange="loadStudentStatistics()">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ/‡∏ï‡∏≠‡∏ô --</option>     
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="statsDateRange">‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                    <input type="date" id="statsStartDate" onchange="loadStudentStatistics()">
                    <span>‡∏ñ‡∏∂‡∏á</span>
                    <input type="date" id="statsEndDate" onchange="loadStudentStatistics()">
                </div>
                
                <div style="margin: 20px 0; text-align: center;">
                    <button onclick="exportStatisticsToExcel()" class="btn-export-all">
                        üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏õ‡πá‡∏ô Excel
                    </button>
                </div>
                
                <div class="loading" id="statsLoading">
                    <div class="spinner"></div>
                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥...</p>
                </div>

                <table class="attendance-table" id="statsTable" style="display: none;">
                    <thead>
                        <tr>
                            <th>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                            <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th>‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                            <th>‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                            <th>‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</th>
                            <th>‡πÑ‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</th>
                            <th>‡∏•‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô</th>
                            <th>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (%)</th>
                        </tr>
                    </thead>
                    <tbody id="statsBody">
                        <!-- Statistics rows will be dynamically added here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Import Help Modal -->
    <div id="importHelpModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìä ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
                <span class="close" onclick="closeModal('importHelpModal')">&times;</span>
            </div>
            
            <div class="help-section">
                <h3>üìã 1. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Google Sheets</h3>
                <p>‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets ‡πÉ‡∏´‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÇ‡∏î‡∏¢‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</p>
                <div class="code-block">
                    ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå A: ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                    ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå B: ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•  
                    ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå C: ‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (y1-com-sec-1, y1-com-sec-2, y2-com-sec-1, ‡∏Ø‡∏•‡∏Ø)
                </div>
                <p>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:</p>
                <table class="preview-table">
                    <tr>
                        <th>A</th>
                        <th>B</th>
                        <th>C</th>
                    </tr>
                    <tr>
                        <td>12345</td>
                        <td>‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ</td>
                        <td>y1-com-sec-1</td>
                    </tr>
                    <tr>
                        <td>12346</td>
                        <td>‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡∏£‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</td>
                        <td>y2-com-sec-1</td>
                    </tr>
                </table>
            </div>

            <div class="help-section">
                <h3>üîó 2. ‡∏´‡∏≤ Spreadsheet ID</h3>
                <p>‡πÄ‡∏õ‡∏¥‡∏î Google Sheets ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π URL ‡∏à‡∏∞‡πÄ‡∏à‡∏≠ ID ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á:</p>
                <div class="code-block">
                    https://docs.google.com/spreadsheets/d/<span style="color: #d73a49; font-weight: bold;">1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms</span>/edit
                </div>
                <p>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏Ñ‡∏∑‡∏≠ Spreadsheet ID</p>
            </div>

            <div class="help-section">
                <h3>üîì 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå</h3>
                <p>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‡πÅ‡∏ä‡∏£‡πå" ‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</p>
                <ul style="margin-left: 20px; color: #555;">
                    <li>‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏•‡∏¥‡∏á‡∏Å‡πå"</li>
                    <li>‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå: "‡∏ú‡∏π‡πâ‡∏î‡∏π" (Viewer)</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Import Preview Modal -->
    <div id="importPreviewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üì• ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤</h2>
                <span class="close" onclick="closeModal('importPreviewModal')">&times;</span>
            </div>
            
            <div id="importPreviewContent" class="import-preview">
                <!-- Preview content will be inserted here -->
            </div>
            
            <div style="margin-top: 20px; text-align: center;">
                <button onclick="confirmImport()" style="background: #28a745;">
                    ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤
                </button>
                <button onclick="closeModal('importPreviewModal')" style="background: #6c757d;">
                    ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                </button>
            </div>
        </div>
    </div>

    <!-- Time Slot Management Modal -->
    <div id="timeSlotModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚è∞ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</h2>
                <span class="close" onclick="closeTimeSlotModal()">&times;</span>
            </div>
            
            <div id="timeSlotContent" class="time-slot-content">
                <!-- Time slot management content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Background Management Modal -->
    <div id="backgroundModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üñºÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏û‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á</h2>
                <span class="close" onclick="closeBackgroundModal()">&times;</span>
            </div>
            
            <div id="backgroundContent" class="background-content">
                <!-- Background management content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Modal ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
    <div id="userSettingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</h2>
                <span class="close" onclick="closeUserSettings()">&times;</span>
            </div>
            <div class="form-group">
                <label for="userProfileName">‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á:</label>
                <input type="text" id="userProfileName" value="" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á">
            </div>
            <div class="form-group">
                <label for="userProfilePicInput">‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå:</label>
                <input type="file" id="userProfilePicInput" accept="image/*">
                <div style="margin-top:10px;">
                    <img id="userProfilePicPreview" src="" alt="‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå" style="display:none;max-width:120px;max-height:120px;border-radius:50%;border:1px solid #ccc;">
                </div>
            </div>
            <div style="margin-top:20px;text-align:right;">
                <button onclick="saveUserSettings()" style="padding:8px 24px;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="app.js"></script>
      <script>
const images = [
  './backend/backgrounds/backgrounds (1).jpg',
  './backend/backgrounds/backgrounds (2).jpg',
  './backend/backgrounds/backgrounds (3).jpg',
  './backend/backgrounds/backgrounds (4).jpg',
    './backend/backgrounds/backgrounds (5).jpg',
    './backend/backgrounds/backgrounds (6).jpg',
    './backend/backgrounds/backgrounds (7).jpg',
    './backend/backgrounds/backgrounds (8).jpg',
];
let current = 0;
const bgDiv = document.querySelector('.background-slideshow');
function showImage(idx) {
  bgDiv.style.backgroundImage = `url('${images[idx]}')`;
  bgDiv.style.backgroundColor = '#e0e0e0'; // fallback color
}
function nextImage() {
  current = (current + 1) % images.length;
  showImage(current);
}
showImage(current);
setInterval(nextImage, 4000);
</script>
      
</body>
</html>